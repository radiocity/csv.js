!function(e,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof module&&module.exports?module.exports=r():e.CSV=r()}("undefined"!=typeof self?self:this,function(){var e=function(r){if(!(this instanceof e))throw new TypeError("Couldn`t call a class as a function");this.config(r)};return e.defaults=function(){return{separator:",",enclosure:'"',escape:'"',linebreak:"\r\n",empty:!1,header:!1}},e.error=function(e){throw e},e.prototype.config=function(r){var t=e.defaults(),n=t;for(var s in t)if(t.hasOwnProperty(s)){var i=t[s];r&&r.hasOwnProperty(s)&&(i=r[s]),this[s]=n[s]=i||""}return n},e.prototype.trimEnclosures=function(e){var r=e[0]===this.enclosure?1:0,t=e[e.length-1]===this.enclosure?e.length-2:e.length;return e.substr(r,t)},e.prototype.parse=function(e){var r=!1,t=0,n=0,s=this.linebreak,i=new Array(new Array);i[t][n]="","\r\n"!=this.linebreak&&"\r"!=this.linebreak&&"\n"!=this.linebreak||(s="\n");for(var a=0;a<e.length;a++)if("\r"!=e[a]||"\n"!==e[a+1])if(r)switch(e[a]){case"\r":case"\n":i[t][n]+="\r\n";break;case this.escape:if(this.escape!==this.enclosure){i[t][n]+=this.escape,e[a+1]===this.enclosure&&(i[t][n]+=this.enclosure,++a);break}case this.enclosure:e[a+1]==this.enclosure?(i[t][n]+=this.enclosure,++a):r=!1;break;default:i[t][n]+=e[a]}else switch(e[a]){case"\r":case"\n":if("\n"!==s){i[t][n]+="\r\n";break}case s:var o=a==e.length;if(!this.empty&&1==i[t].length&&""==i[t][0]||o)break;n=0,i[++t]=new Array("");break;case this.separator:i[t][++n]="";break;case this.enclosure:if(0==i[t][n].length){r=!0;break}default:i[t][n]+=e[a]}return 1==i[t].length&&0==i[t][n].length&&i.splice(t,1),i},e.prototype.json=function(e){if("string"==typeof e&&(e=this.parse(e)),this.header)for(var r=e.shift(),t=0;t<e.length;t++){for(var n={},s=0;s<e[t].length;s++)n[r[s]||s]=e[t][s]||"";e[t]=n}return JSON.stringify(e)},e});